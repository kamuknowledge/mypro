<?php
	$error = $this;
	$experiance = isset($this->UserDetails[0]) ? $this->UserDetails[0] : "";
	$experiance_id = $experiance["experience_id"];
	$company_name = $experiance["company_name"];
	$job_location = $experiance["job_location"];
	$country_id = $experiance["country_id"];
	$job_title = $experiance["job_title"];
	$industry_id = $experiance["industry_id"];
	$state_id = $experiance["state_id"];
	$from_month = $experiance["from_month"];
	$from_year = $experiance["from_year"];
	$to_month = $experiance["to_month"];
	$to_year = $experiance["to_year"];
	$present_working = $experiance["present_working"];
	$company_description = $experiance["company_description"];
?>
<script>
$(document).ready(function(){
	var save_type = "<?php echo ($experiance_id && $experiance_id != "new") ? "edit" : "new"; ?>";
	$("#experiance_form_<?php echo $experiance_id; ?>").validate({
		rules : {
			company_name : {
				required : true
			}, 
			job_title : {
				required : true
			},
			industry : {
				required : true
			},
			job_location : {
				required : true
			}
		},
		messages : {
			company_name : {
				required : "Company name is required."
			},
			job_title : {
				required : "Position is required."
			},
			industry : {
				required : "Industry is required."
			},
			job_location : {
				required : "Industry is required."
			}
		},
		submitHandler: function(form) {
			var str = $("#experiance_form_<?php echo $experiance_id; ?>").serialize();
			//$("#login_user").html("Loading...");
			$.ajax({
				type : "POST",
				url : baseUrl+"/profile/vieweditexperiance",
				data : "type="+save_type+"&"+str,
				beforeSend : function() {
					$("#experiance_edit_loading_<?php echo $experiance_id; ?>").show();
				},
				success : function(data) {
					if(save_type == "new") {
						$("#experiance_view_<?php echo $experiance_id; ?>").html("");
						$("#experiance_edit_<?php echo $experiance_id; ?>").html("");
						$("#experiance_view_<?php echo $experiance_id; ?>").hide();
						$("#experiance_edit_<?php echo $experiance_id; ?>").hide();
						$("#experiance_edit_<?php echo $experiance_id; ?>").after(data);
					} else {
						$("#experiance_view_<?php echo $experiance_id; ?>").html(data);
						$("#experiance_edit_loading_<?php echo $experiance_id; ?>").hide();
						$("#experiance_edit_<?php echo $experiance_id; ?>").hide();
						$("#experiance_view_<?php echo $experiance_id; ?>").show();
					}
					return false;
				}
			});
		}
	});
});
function submit_exp_form(form) {
	$("#"+form).submit();
}
function cancel_exp_form(id) {
	$("#experiance_edit_"+id).hide();
	$("#experiance_view_"+id).show();
}
</script>
<form name="experiance_form_<?php echo $experiance_id; ?>" id="experiance_form_<?php echo $experiance_id; ?>">
<div class="desc">
	<div class="add_experience_form form">
		<div class="left width-50">
			<div class="row">
				<label>Company Name:</label>
				<input type="text" value="<?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['company_name']; } else { echo $company_name; } ?>" id="company_name" name="company_name" <?php if($error->error_company_name != '') { echo 'class="error"'; } ?> />
				<?php 
					if($error->error_company_name != '') {
						echo '<label for="company_name" generated="true" class="error" style="">' .$error->error_company_name . '</label>';
						$error->error_company_name = '';
					}
				?>
			</div>
			<div class="row">
				<label>Location:</label>
				<input type="text" value="<?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['job_location']; } else { echo $job_location; } ?>" id="job_location" name="job_location" <?php if($error->error_location_name != '') { echo 'class="error"'; } ?> />
				<?php 
					if($error->error_location_name != '') {
						echo '<label for="job_location" generated="true" class="error" style="">' .$error->error_location_name . '</label>';
						$error->error_location_name = '';
					}
				?>
			</div>
			<div class="row">
				<label>Country:</label>
				<select id="country" name="country">
					<option>Please Select Country..</option>
					<option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['country']; } else { echo $country_id; } ?></option>
				</select>
			</div>
		</div>
		<div class="right width-50">
			<div class="row">
				<label>Position:</label>
				<input type="text" value="<?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['job_title']; } else { echo $job_title; } ?>" id="job_title" name="job_title" <?php if($error->error_position_name != '') { echo 'class="error"'; } ?>/>
				<?php 
					if($error->error_position_name != '') {
						echo '<label for="job_title" generated="true" class="error" style="">' .$error->error_position_name . '</label>';
						$error->error_position_name = '';
					}
				?>
			</div>
			<div class="row">
				<label>Industry:</label>
				<select id="industry" name="industry">
					<option>Select Industry..</option>
					<option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['industry']; } else { echo $industry_id; } ?></option>
				</select>
			</div>
			<div class="row">
				<label>State:</label>
				<select id="state" name="state">
					<option>Select State..</option>
					<option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['state']; } else { echo $state_id; } ?></option>
				</select>
			</div>
		</div>
		<div class="row">
			<label class="width-15">Time Period : </label>
			<div class="fields-container">
				<div class="row">
					<select id="from_month" name="from_month"><option>Month</option><option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['from_month']; } else { echo $from_month; } ?></option></select>
					<select id="from_year" name="from_year"><option>Year</option><option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['from_year']; } else { echo $from_year; } ?></option></select>
					<select id="to_month" name="to_month"><option>Month</option><option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['to_month']; } else { echo $to_month; } ?></option></select>
					<select id="to_year" name="to_year"><option>Year</option><option><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['to_year']; } else { echo $to_year; } ?></option></select>
					<input type="checkbox" style="margin-top: 7px;"<?php if(is_array($error->error_experiance_values)) { echo ($error->error_experiance_values['present_working']) ? 'checked="checked"' : ""; } else { echo ($present_working) ? 'checked="checked"' : ""; } ?> id="present_working" name="present_working"><label>Present Working Here.</label>
					<div class="clear"></div>
				</div>
			</div>
		</div>
		<div class="row">
			<label class="width-15">Description : </label>
			<textarea style="width: 80%;" rows="6" id="description" name="description"><?php if(is_array($error->error_experiance_values)) { echo $error->error_experiance_values['description']; } else { echo $company_description; } ?></textarea>
			<div class="info"  style="margin-left: 15%;"><span class="blue">2500</span> Words Remaining.</div>
			<div class="text-right">
				<a class="button-dark add" href="javascript:void(0)" onclick="submit_exp_form('experiance_form_<?php echo $experiance_id; ?>')"><span><span>Save</span></span></a>
				<a class="button-grey add" href="javascript:void(0)"onclick="cancel_exp_form('<?php echo $experiance_id; ?>')"><span><span>Cancel</span></span></a>
				<div class="clear"></div>
			</div>
		</div>
		<div class="clear"></div>
	</div>
</div>
<input type='hidden' id="exp_id" name="exp_id" value="<?php echo $experiance_id; ?>" />
</form>